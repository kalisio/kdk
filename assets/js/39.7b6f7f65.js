(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{573:function(e,t,s){"use strict";s.r(t);var a=s(13),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"configure-your-app"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-your-app"}},[e._v("#")]),e._v(" Configure your app")]),e._v(" "),s("h2",{attrs:{id:"configure-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-application"}},[e._v("#")]),e._v(" Configure application")]),e._v(" "),s("p",[e._v("Depending on the third-party services you need you will have to do the following:")]),e._v(" "),s("ul",[s("li",[e._v("Generate a secret to secure your authentication, use one generated by the Feathers CLI")]),e._v(" "),s("li",[e._v("Create a Firebase app in the "),s("a",{attrs:{href:"https://console.firebase.google.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Firebase Console"),s("OutboundLink")],1),e._v(" "),s("ul",[s("li",[e._v("retrieve the "),s("code",[e._v("google-services.json")]),e._v(" to be stored as a secret file in the "),s("em",[e._v("cordova")]),e._v(" directory")]),e._v(" "),s("li",[e._v("create an Android app in your Firebase app and keep track of secret server key in "),s("em",[e._v("Parameters > Cloud Messaging")])])])]),e._v(" "),s("li",[e._v("Create a GCM application in the "),s("a",{attrs:{href:"https://eu-west-1.console.aws.amazon.com/sns/v2/home",target:"_blank",rel:"noopener noreferrer"}},[e._v("AWS SNS console"),s("OutboundLink")],1),e._v(" using the previous server key\n"),s("ul",[s("li",[e._v("keep track of app ARN")])])]),e._v(" "),s("li",[e._v("Create a new project for your app in the "),s("a",{attrs:{href:"https://console.cloud.google.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Cloud Console"),s("OutboundLink")],1),e._v(" "),s("ul",[s("li",[e._v("Activate the Google+ API on your project")])])]),e._v(" "),s("li",[e._v("Create an OAuth2 ID for a Web App in "),s("a",{attrs:{href:"https://console.cloud.google.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Cloud Console"),s("OutboundLink")],1),e._v(" > "),s("em",[e._v("API & services")]),e._v(" "),s("ul",[s("li",[e._v("the redirect URL should match "),s("em",[e._v("your.domain/auth/google/callback")])]),e._v(" "),s("li",[e._v("download the "),s("em",[e._v("json")]),e._v(" dans keep track of client ID and secret")])])]),e._v(" "),s("li",[e._v("Create an OAuth2 App in "),s("a",{attrs:{href:"https://github.com/organizations/kalisio/settings/applications",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub"),s("OutboundLink")],1),e._v(" "),s("ul",[s("li",[e._v("the redirect URL should match "),s("em",[e._v("your.domain/auth/github/callback")])]),e._v(" "),s("li",[e._v("download the "),s("em",[e._v("json")]),e._v(" dans keep track of client ID and secret")])])]),e._v(" "),s("li",[e._v("Create an AWS user in "),s("a",{attrs:{href:"https://console.aws.amazon.com/iam/home",target:"_blank",rel:"noopener noreferrer"}},[e._v("IAM"),s("OutboundLink")],1),e._v(" with access to S3 API (e.g. "),s("em",[e._v("AmazonS3FullAccess")]),e._v(")\n"),s("ul",[s("li",[e._v("keep track of access key ID and secret")])])]),e._v(" "),s("li",[e._v("Create a bucket for your app in the Kalisio account\n"),s("ul",[s("li",[e._v("keep track of its name")])])]),e._v(" "),s("li",[e._v("Create an AWS user in "),s("a",{attrs:{href:"https://console.aws.amazon.com/iam/home",target:"_blank",rel:"noopener noreferrer"}},[e._v("IAM"),s("OutboundLink")],1),e._v(" with access to SNS API (e.g. "),s("em",[e._v("AmazonSNSFullAccess")]),e._v(")\n"),s("ul",[s("li",[e._v("keep track of access key ID and secret")])])])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("Note: some of the previous accounts/IDs are not app specific and can be share accross multiple apps, e.g. S3, SNS, etc.")])]),e._v(" "),s("p",[e._v("Create required environment variables in a script file you can source before launching your app:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("APP_SECRET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GOOGLE_MAIL_USER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GOOGLE_MAIL_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SNS_ACCESS_KEY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SNS_SECRET_ACCESS_KEY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SNS_ANDROID_ARN")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("S3_ACCESS_KEY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("S3_SECRET_ACCESS_KEY")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("S3_BUCKET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GITHUB_CLIENT_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GITHUB_CLIENT_SECRET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GOOGLE_CLIENT_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("export")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("GOOGLE_CLIENT_SECRET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("xxx\n")])])]),s("p",[e._v("Then, retrieve this variables in config files like this:")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("github")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("clientID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[e._v("GITHUB_CLIENT_ID")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[e._v("clientSecret")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[e._v("GITHUB_CLIENT_SECRET")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("p",[e._v("In your local development environment you should use the script to setup all the required secrets. This script should be safe-guarded in a non-public environment.")]),e._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("You should never store production passwords or other sensitive production data in a clear form in public source code or config files.")])]),e._v(" "),s("p",[e._v("During the "),s("RouterLink",{attrs:{to:"/guides/development/deploy.html"}},[e._v("CI/CD process")]),e._v(" the script "),s("em",[e._v("travis.env.sh")]),e._v(" automatically generates a temporary environment file, based on the secret environment variables defined in your Travis repository settings or coming from a dedicated private repository (in this case only the access token of this repository needs to be in your Travis settings), to be sourced at the different stages.")],1),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("You shouldn't use production secrets in development and test mode.")])]),e._v(" "),s("p",[e._v("To avoid publishing by error production secrets we recommand generating an access key/token for each flavor "),s("em",[e._v("AND")]),e._v(" third-party service required by your app using the following naming convention for these tokens: "),s("strong",[e._v("flavor-service")]),e._v(". For instance you would have a "),s("strong",[e._v("dev-s3")]),e._v(", "),s("strong",[e._v("test-s3")]),e._v(" and "),s("strong",[e._v("prod-s3")]),e._v(" keys to use the AWS S3 service respectively in your dev, test and production version of your app.")]),e._v(" "),s("h2",{attrs:{id:"configure-ci-cd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-ci-cd"}},[e._v("#")]),e._v(" Configure CI/CD")]),e._v(" "),s("p",[e._v("As the application and the CI/CD build relies on third-party services its configuration must include secrets like API keys, passwords, etc. and "),s("strong",[e._v("should not be pushed under source control unless you use private repositories or encryption")]),e._v(". The "),s("RouterLink",{attrs:{to:"/guides/development/deploy.html"}},[e._v("CI/CD section")]),e._v(" explains how we manage it efficiently in a secure way but this section details some basic mechanisms you can use if you need to store some CI/CD specific data securely.")],1),e._v(" "),s("h3",{attrs:{id:"secret-variables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#secret-variables"}},[e._v("#")]),e._v(" Secret variables")]),e._v(" "),s("p",[e._v("If some of the sensitive data are stored using environment variables, you have to use "),s("a",{attrs:{href:"https://docs.travis-ci.com/user/environment-variables/",target:"_blank",rel:"noopener noreferrer"}},[e._v("encrypted environment variables"),s("OutboundLink")],1),e._v(" set either in build file or repository settings.")]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("If you'd like to set a value holding multilines or special characters take care to surround it with "),s("code",[e._v('"')]),e._v(" so that it will be properly escaped.")])]),e._v(" "),s("h3",{attrs:{id:"secret-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#secret-file"}},[e._v("#")]),e._v(" Secret file")]),e._v(" "),s("p",[e._v("If you need additional sensitive data stored through "),s("a",{attrs:{href:"https://docs.travis-ci.com/user/encrypting-files/",target:"_blank",rel:"noopener noreferrer"}},[e._v("files"),s("OutboundLink")],1),e._v(" create a "),s("em",[e._v("secrets.tar")]),e._v(" containing all secured files and encode it to "),s("em",[e._v("secrets.tar.enc")]),e._v(" a using "),s("RouterLink",{attrs:{to:"/tools/cli.html#travis-cli"}},[e._v("Travis CLI")]),e._v(". This file will be decrypted before the build or whenever you need something inside.")],1),e._v(" "),s("p",[e._v("Indeed, as mentioned in the "),s("a",{attrs:{href:"https://docs.travis-ci.com/user/encrypting-files/#Encrypting-multiple-files",target:"_blank",rel:"noopener noreferrer"}},[e._v("documentation"),s("OutboundLink")],1),e._v(", it is not possible to encrypt multiple files and thus requires to create a "),s("code",[e._v("tar")]),e._v(" file containing the different secret files and encrypts the archive.")]),e._v(" "),s("p",[e._v("The table below lists for example the required files to publish a mobile app using Cordova:")]),e._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[e._v("File")]),e._v(" "),s("th",{staticStyle:{"text-align":"left"}},[e._v("Description")])])]),e._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[e._v("keystore file")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("A binary file containing the private key of the certificate you need to sign the Android app")])]),e._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[e._v("cordova build file")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("A Json file used by Cordova to sign the generated application. It uses the keystore file")])]),e._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[e._v("google play service account")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("A Json file storing the data needed to use the Google Play service account")])]),e._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[e._v("google services account")]),e._v(" "),s("td",{staticStyle:{"text-align":"left"}},[e._v("A Json file storing the the keys to access the various Google services")])])])]),e._v(" "),s("p",[e._v("You need to be logged into Travis CI before generating the secret file like this:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("tar cvf secrets.tar your_keystore.keystore build.json google-play.json google-services.json\ntravis encrypt-file secrets.tar\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);