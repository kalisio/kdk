(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{578:function(t,s,e){"use strict";e.r(s);var a=e(13),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"testing-with-kdk"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#testing-with-kdk"}},[t._v("#")]),t._v(" Testing with KDK")]),t._v(" "),e("p",[t._v("The "),e("strong",[t._v("KDK")]),t._v(" relies on the "),e("a",{attrs:{href:"https://mochajs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mocha"),e("OutboundLink")],1),t._v(" testing framework and the "),e("a",{attrs:{href:"https://www.chaijs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chai"),e("OutboundLink")],1),t._v(" assertion library.")]),t._v(" "),e("h2",{attrs:{id:"modules-plugins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modules-plugins"}},[t._v("#")]),t._v(" Modules/Plugins")]),t._v(" "),e("p",[t._v("Kalisio modules/plugins are "),e("a",{attrs:{href:"https://docs.feathersjs.com/guides/basics/testing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Feathers modules"),e("OutboundLink")],1),t._v(", so you will find most of the required information in the linked Feathers documentation.")]),t._v(" "),e("p",[t._v("To run the module tests including linting and coverage : "),e("code",[t._v("$ yarn test")])]),t._v(" "),e("p",[t._v("To speed-up things simply run the tests with: "),e("code",[t._v("$ yarn mocha")])]),t._v(" "),e("p",[t._v("You can run the tests of each submodule independently using the following commands for the KDK:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" mocha:core   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# test the core module")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" mocha:map    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# test the map module")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("If you need to perform some specific tests, you can use the "),e("code",[t._v("-g")]),t._v(" or "),e("code",[t._v("--grep")]),t._v(" option of the "),e("code",[t._v("mocha")]),t._v(" command:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" mocha:core -g "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"core:team"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# run the team tests")]),t._v("\n")])])])]),t._v(" "),e("h2",{attrs:{id:"web-app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web-app"}},[t._v("#")]),t._v(" Web app")]),t._v(" "),e("h3",{attrs:{id:"api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),e("p",[t._v("From the root folder run the server-side tests:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" test:server\n")])])]),e("p",[t._v("This will lint and fix issues in the code according to "),e("a",{attrs:{href:"https://github.com/feross/standard",target:"_blank",rel:"noopener noreferrer"}},[t._v("JS standard"),e("OutboundLink")],1),t._v(", then execute tests using "),e("a",{attrs:{href:"https://mochajs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mocha"),e("OutboundLink")],1),t._v(" and compute code coverage using "),e("a",{attrs:{href:"https://istanbul.js.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Istanbul"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("From the backend "),e("code",[t._v("api")]),t._v(" folder you can also run the server-side tests like for modules:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# with lint/coverage")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# without lint/coverage")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" mocha\n")])])]),e("h3",{attrs:{id:"client"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#client"}},[t._v("#")]),t._v(" Client")]),t._v(" "),e("p",[t._v("From the root folder first "),e("RouterLink",{attrs:{to:"/guides/development/develop.html#web-app"}},[t._v("run the web app")]),t._v(", then the client-side tests:")],1),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" test:client\n")])])]),e("p",[t._v("This will execute tests using "),e("a",{attrs:{href:"https://mochajs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mocha"),e("OutboundLink")],1),t._v("/"),e("a",{attrs:{href:"https://github.com/puppeteer/puppeteer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Puppeteer"),e("OutboundLink")],1),t._v(" and compute code coverage using "),e("a",{attrs:{href:"https://istanbul.js.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Istanbul"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("From the root folder you can also run the client-side tests without coverage like for modules:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" mocha\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("If you need to run some specific tests suite only, you can use the "),e("code",[t._v("-g")]),t._v(" or "),e("code",[t._v("--grep")]),t._v(" option of the "),e("code",[t._v("mocha")]),t._v(" command:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$yarn")]),t._v(" mocha -g "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"suite:groups"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# run the groups tests")]),t._v("\n")])])])]),t._v(" "),e("h3",{attrs:{id:"writing-client-tests"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#writing-client-tests"}},[t._v("#")]),t._v(" Writing client tests")]),t._v(" "),e("p",[t._v("In addition to "),e("strong",[t._v("Mocha")]),t._v(" and "),e("strong",[t._v("Chai")]),t._v(" helpers, the "),e("strong",[t._v("KDK")]),t._v(" provides helper functions to test your UI using "),e("a",{attrs:{href:"https://github.com/puppeteer/puppeteer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Puppeteer"),e("OutboundLink")],1),t._v(":")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("test your UI components: the "),e("strong",[t._v("Runner class")]),t._v(" allows you to manage a "),e("strong",[t._v("Puppereer")]),t._v(" browser as well as the default page attached to this browser. In addition, it provides a useful inteface to override permissions, set items in local storage, catch warnings and error messages from the console, take screenshots and compare them to some reference images.")])]),t._v(" "),e("li",[e("p",[t._v("deal with your app's API: the "),e("strong",[t._v("Api class")]),t._v(" allows you to access the differents services exposed by the API.")])]),t._v(" "),e("li",[e("p",[t._v("structure your project test structure: the "),e("strong",[t._v("KDK")]),t._v(" assumes that a directory has been assigned to each "),e("strong",[t._v("test suite")]),t._v(" in order to store test data. These directories, are stored in a more general "),e("code",[t._v("data")]),t._v(" directory and must be named with the "),e("strong",[t._v("test suite")]),t._v(" name. If you have any screenshot references then then they must stored in a decidacted sub directory named "),e("code",[t._v("screenrefs")]),t._v(".")])])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ data \n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#2")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ screenrefs\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#3")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ screenrefs\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite1.test.js\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite2.test.js\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite3.test.js\n")])])]),e("p",[t._v("When running the test data are generally generated in order to be compared to the static test data. The "),e("strong",[t._v("Runner")]),t._v(" creates a "),e("code",[t._v("run")]),t._v(" directory where it stores for the browser (e.g. chrome, firefox) the data for each "),e("strong",[t._v("test suite")]),t._v(". For instance:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_run\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ chrome\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#2")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("       "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("_ suite"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#3")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("The "),e("strong",[t._v("Runner")]),t._v(" clears its corresponding "),e("strong",[t._v("test suite")]),t._v(" run directory each time you run it.")])]),t._v(" "),e("h4",{attrs:{id:"core"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#core"}},[t._v("#")]),t._v(" Core")]),t._v(" "),e("h5",{attrs:{id:"runner"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#runner"}},[t._v("#")]),t._v(" Runner")]),t._v(" "),e("p",[t._v("In pratice, a "),e("strong",[t._v("Runner")]),t._v(" instance has to be created in each "),e("strong",[t._v("test suite")]),t._v(". You should declare the "),e("strong",[t._v("Runner")]),t._v(" in the "),e("strong",[t._v("before")]),t._v(" hook as well as starting. Starting the "),e("strong",[t._v("Runner")]),t._v(" creates the "),e("strong",[t._v("Puppeteer Browser")]),t._v(" and the default page. Obviously, you should stop the "),e("strong",[t._v("Runner")]),t._v(" which causes the Puppeteer Browser to be closed in the "),e("strong",[t._v("after")]),t._v(" hook.")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" core "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@kalisio/kdk/test.client'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" suite "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-suite'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("describe")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("suite"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" runner\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" page\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("before")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    runner "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("core"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Runner")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("suite"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("browser")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("args")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'--lang=fr'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    page "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" runner"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-test'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("after")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" runner"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h4",{attrs:{id:"map"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#map"}},[t._v("#")]),t._v(" Map")]),t._v(" "),e("p",[e("strong",[t._v("TODO")])])])}),[],!1,null,null,null);s.default=r.exports}}]);