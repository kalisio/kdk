# v2.5 - Not yet released

More details can be found in the related [milestone](https://github.com/kalisio/kdk/milestone/13) on GitHub.

## Major breaking changes

üí• Exposed properties changed in composable `activity.js`. `state`, `options` and `name` properties are now exposed using a more global object `CurrentActivityContext` which is reactive (see https://github.com/kalisio/kdk/issues/1055). 

::: tip 
To retrieve the `state` of the `CurrentActivity` you can now proceed that way:

```js
const { CurrentActivityContext } = useCurrentActivity()
const { state } = CurrentActivityContext
```
:::

::: warning
When using the composable `activity.js` from an another composable be aware that the `CurrentActivity` is not set and the `CurrentActivityContext` exposed properties are `null`. You should watch the `CurrentActivity` value to use the `CurrentActivityContext`object.
:::

üí• Renamed composable file `counter.js` to `collection-counter.js`. Therefore, the `useCounter` function is renamed to `useCollectionCounter`. 

## Major new features

üëâ New `KRequestProgressBar` component to be used in your `App.vue` or equivalent in order to display a progress bar whenever a request to the server is processing.

üëâ New `useErrors()` composable to be used in your `App.vue` or equivalent in order to display a notification whenever a request to the server raises an error.

üëâ Ability for JWTs to target a user using others properties than the user ID, applications should allow this in their authentication configuration otherwise the default behavior still relies on the user ID.

::: details ‚¨áÔ∏è Example of an authentication configuration to allow JWT identifying a user by email
```js
// default.js of your application, assuming your user objects have an email properties
authentication: {
	identityFields: ['email'],
	...
}
```

Your JWT can now be issued [as usual](https://kalisio.github.io/skeleton/guides/development/tips.html#personal-access-token) but using a payload like this:
```json
{
  "aud": "kalisio.xyz",
  "iss": "kalisio",
  "exp": 1552402010,
  "sub": "user_email@gmail.com"
}
```
:::

üëâ New `KOAuthLoginScreen` and `KOAuthLogouScreen` components to be used in your app when relying on an OAuth provider instead of local authentication.

::: details ‚¨áÔ∏è Example of configurations to be used to allow single login/logout with a `keycloak` provider
```js
// frontend route.js of your application
{
  login: 'screen/KOAuthLoginScreen',
  'logout/:provider?': {
    name: 'logout',
    component: 'screen/KOAuthLogoutScreen',
    ...
  },
  ...
}
// frontend default.js of your application
screens: {
  login: {
    actions: [
      { id: 'keycloak-link', label: 'screen.LOGIN_WITH_KEYCLOAK', renderer: 'form-button', route: { url: '/oauth/keycloak' } }
    ]
  }
},
leftPane: {
  content: [
    ...,
    { id: 'logout', icon: 'las la-sign-out-alt', label: 'sideNav.LOGOUT', route: { name: 'logout', params: { provider: 'keycloak' } }, renderer: 'item' }
  ]
},
...

// backend default.js of your application
authentication: {
  oauth: {
    keycloak: {
      ...,
      logout_url: `${keycloakBaseUrl}/logout`
    }
  }
  ...
}
```
:::