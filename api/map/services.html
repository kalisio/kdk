<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Services | KDK</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="https://s3.eu-central-1.amazonaws.com/kalisioscope/kdk/kdk-icon-64x64.png">
    <link rel="manifest" href="/kdk/manifest.json">
    <meta name="description" content="The Kalisio Development Kit">
    
    <link rel="preload" href="/kdk/assets/css/0.styles.50736a5c.css" as="style"><link rel="preload" href="/kdk/assets/js/app.2ba7f0d3.js" as="script"><link rel="preload" href="/kdk/assets/js/3.934b6e1d.js" as="script"><link rel="preload" href="/kdk/assets/js/6.6c7d3e51.js" as="script"><link rel="preload" href="/kdk/assets/js/9.07565a82.js" as="script"><link rel="prefetch" href="/kdk/assets/js/10.781be977.js"><link rel="prefetch" href="/kdk/assets/js/11.31827355.js"><link rel="prefetch" href="/kdk/assets/js/12.c9b0320b.js"><link rel="prefetch" href="/kdk/assets/js/13.2258bc6b.js"><link rel="prefetch" href="/kdk/assets/js/14.47c0a2b4.js"><link rel="prefetch" href="/kdk/assets/js/15.730c1fa7.js"><link rel="prefetch" href="/kdk/assets/js/16.bd714368.js"><link rel="prefetch" href="/kdk/assets/js/17.7dc92894.js"><link rel="prefetch" href="/kdk/assets/js/18.76c98707.js"><link rel="prefetch" href="/kdk/assets/js/19.6aa67e39.js"><link rel="prefetch" href="/kdk/assets/js/2.74a99991.js"><link rel="prefetch" href="/kdk/assets/js/20.0835256d.js"><link rel="prefetch" href="/kdk/assets/js/21.6192c6ca.js"><link rel="prefetch" href="/kdk/assets/js/22.6b73cedb.js"><link rel="prefetch" href="/kdk/assets/js/23.ec6c0ed6.js"><link rel="prefetch" href="/kdk/assets/js/24.824ae611.js"><link rel="prefetch" href="/kdk/assets/js/25.f5c8a13a.js"><link rel="prefetch" href="/kdk/assets/js/26.6aa473d4.js"><link rel="prefetch" href="/kdk/assets/js/27.4654bd50.js"><link rel="prefetch" href="/kdk/assets/js/28.99577333.js"><link rel="prefetch" href="/kdk/assets/js/29.fbabc77c.js"><link rel="prefetch" href="/kdk/assets/js/30.e640f814.js"><link rel="prefetch" href="/kdk/assets/js/31.2ee15340.js"><link rel="prefetch" href="/kdk/assets/js/32.cd0afe38.js"><link rel="prefetch" href="/kdk/assets/js/33.4b38a62b.js"><link rel="prefetch" href="/kdk/assets/js/34.97fee52f.js"><link rel="prefetch" href="/kdk/assets/js/35.52c15a92.js"><link rel="prefetch" href="/kdk/assets/js/36.7a31460b.js"><link rel="prefetch" href="/kdk/assets/js/37.c9ed3b37.js"><link rel="prefetch" href="/kdk/assets/js/38.90400ea4.js"><link rel="prefetch" href="/kdk/assets/js/39.f103ef3a.js"><link rel="prefetch" href="/kdk/assets/js/4.f12e5706.js"><link rel="prefetch" href="/kdk/assets/js/40.6befadbc.js"><link rel="prefetch" href="/kdk/assets/js/41.9ef837e1.js"><link rel="prefetch" href="/kdk/assets/js/42.75d6a1ed.js"><link rel="prefetch" href="/kdk/assets/js/43.830fd67c.js"><link rel="prefetch" href="/kdk/assets/js/44.902e6282.js"><link rel="prefetch" href="/kdk/assets/js/45.196413f4.js"><link rel="prefetch" href="/kdk/assets/js/46.d59b3c45.js"><link rel="prefetch" href="/kdk/assets/js/47.751b78a9.js"><link rel="prefetch" href="/kdk/assets/js/48.be5bc7b9.js"><link rel="prefetch" href="/kdk/assets/js/49.83c79b33.js"><link rel="prefetch" href="/kdk/assets/js/5.e9941444.js"><link rel="prefetch" href="/kdk/assets/js/50.ca7da09f.js"><link rel="prefetch" href="/kdk/assets/js/51.b03dea6d.js"><link rel="prefetch" href="/kdk/assets/js/52.7b16b2ec.js"><link rel="prefetch" href="/kdk/assets/js/53.61fab3f5.js"><link rel="prefetch" href="/kdk/assets/js/54.cae0b269.js"><link rel="prefetch" href="/kdk/assets/js/55.96396b6a.js"><link rel="prefetch" href="/kdk/assets/js/7.dbcb153c.js"><link rel="prefetch" href="/kdk/assets/js/8.41c50df0.js">
    <link rel="stylesheet" href="/kdk/assets/css/0.styles.50736a5c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/kdk/" class="home-link router-link-active"><!----> <span class="site-name">KDK</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/kdk/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/kdk/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/kdk/architecture/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/kdk/api/" class="nav-link router-link-active">
  API
</a></div><div class="nav-item"><a href="/kdk/tips/" class="nav-link">
  Tips
</a></div><div class="nav-item"><a href="/kdk/tools/" class="nav-link">
  Tools
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/kdk/about/" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/kdk/guides/" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="/kdk/architecture/" class="nav-link">
  Architecture
</a></div><div class="nav-item"><a href="/kdk/api/" class="nav-link router-link-active">
  API
</a></div><div class="nav-item"><a href="/kdk/tips/" class="nav-link">
  Tips
</a></div><div class="nav-item"><a href="/kdk/tools/" class="nav-link">
  Tools
</a></div> <!----></nav> <p align="center"><a href="https://kalisio.com"><img src="https://s3.eu-central-1.amazonaws.com/kalisioscope/kalisio/kalisio-logo-black-256x84.png"></a> <br> <!----></p> <ul class="sidebar-links"><li><a href="/kdk/api/" aria-current="page" class="sidebar-link">API</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>core</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>map</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/kdk/api/map/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/kdk/api/map/services.html" aria-current="page" class="active sidebar-link">Services</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kdk/api/map/services.html#geocoder-service" class="sidebar-link">Geocoder service</a></li><li class="sidebar-sub-header"><a href="/kdk/api/map/services.html#catalog-service" class="sidebar-link">Catalog service</a></li><li class="sidebar-sub-header"><a href="/kdk/api/map/services.html#features-service" class="sidebar-link">Features service</a></li><li class="sidebar-sub-header"><a href="/kdk/api/map/services.html#alerts-service" class="sidebar-link">Alerts service</a></li></ul></li><li><a href="/kdk/api/map/hooks.html" class="sidebar-link">Hooks</a></li><li><a href="/kdk/api/map/components.html" class="sidebar-link">Components</a></li><li><a href="/kdk/api/map/mixins.html" class="sidebar-link">Mixins</a></li><li><a href="/kdk/api/map/map-mixins.html" class="sidebar-link">Map Mixins</a></li><li><a href="/kdk/api/map/globe-mixins.html" class="sidebar-link">Globe Mixins</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="services"><a href="#services" class="header-anchor">#</a> Services</h1> <h2 id="geocoder-service"><a href="#geocoder-service" class="header-anchor">#</a> Geocoder service</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Available as a global service</p></div> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p><code>create</code> method is the only one allowed from the client/server side</p></div> <p>Rely on <a href="https://github.com/nchaulet/node-geocoder" target="_blank" rel="noopener noreferrer">node-geocoder<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> under-the-hood.</p> <h3 id="data-model"><a href="#data-model" class="header-anchor">#</a> Data model</h3> <p>The data model of a geocoding request as used by the API only contains the <strong>address</strong> field specifying the string to be looked for. The request response depends on the geocoding provider although there is a set of common properties, see example below.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> service <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token string">'geocoder'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> results <span class="token operator">=</span> <span class="token keyword">await</span> service<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token string">'29 champs elysée paris'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> latitude<span class="token punctuation">,</span> longitude<span class="token punctuation">,</span> country<span class="token punctuation">,</span> state<span class="token punctuation">,</span>
  		streetNumber<span class="token punctuation">,</span> streetName<span class="token punctuation">,</span> city<span class="token punctuation">,</span> zipcode <span class="token punctuation">}</span> <span class="token operator">=</span> element
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="hooks"><a href="#hooks" class="header-anchor">#</a> Hooks</h3> <p>No <a href="/kdk/api/map/hooks.html">hooks</a> are executed on the <code>geocoder</code> service for now.</p> <h2 id="catalog-service"><a href="#catalog-service" class="header-anchor">#</a> Catalog service</h2> <p>This service aims at storing the definition of the available map layers or map view contexts (extent and active layers).</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Available as a global and a contextual service</p></div> <p>The service can be created using the global <strong>createCatalogService(context, db)</strong> function, if no arguments provided it will be available as a global service otherwise as a contextual service (e.g. attached to a specific organization), please also refer to core module <a href="/kdk/api/core/application.html#createservice-name-options"><strong>createService()</strong></a>.</p> <p>Here is a sample code to retrieve all data layer descriptors available in the catalog:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> catalogService <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token string">'catalog'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> catalogService<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
_<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">layer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>layer<span class="token punctuation">[</span>engine<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	  <span class="token comment">// Process i18n if you'd like to</span>
	  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> layer<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>description<span class="token punctuation">)</span><span class="token punctuation">)</span> layer<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$t</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>description<span class="token punctuation">)</span>
	  <span class="token comment">// Create the underlying layer object in the map/globe</span>
	  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>By default the catalog filters contexts and return layers only if the target object <code>type</code> is unspecified.</p></div> <p>Here is a sample code to retrieve the default context (i.e. home view) available in the catalog:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> catalogService <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token string">'catalog'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">await</span> catalogService<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'Context'</span><span class="token punctuation">,</span> isDefault<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadContext</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="data-model-2"><a href="#data-model-2" class="header-anchor">#</a> Data model</h3> <h4 id="layer"><a href="#layer" class="header-anchor">#</a> Layer</h4> <p>The data model of a layer descriptor as used by the API is detailed below.</p> <p><img src="/kdk/assets/img/catalog-data-model.998b319c.png" alt="Catalog data model"></p> <p>The catalog is typically populated at application startup with a default set of layers, as a consequence the best is to have a look at some of our application configuration files like the one of <a href="https://github.com/kalisio/kano/blob/master/api/config/layers" target="_blank" rel="noopener noreferrer">Kano<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>The details of each property are the following:</p> <ul><li><strong>name</strong> : the layer name, typically used in the <a href="/kdk/api/map/components.html#catalog-panel">catalog panel</a></li> <li><strong>description</strong> : the layer short description, typically used in the <a href="/kdk/api/map/components.html#catalog-panel">catalog panel</a></li> <li><strong>i18n</strong>: layer translations, see <a href="/kdk/api/core/application.html#client-ecosystem">application internationalization</a> for details
<ul><li><strong>locale</strong>: translations for a target locale eg <code>FR</code> <ul><li><strong>Layers</strong>: translation keys/values for layer fields</li> <li><strong>Variables</strong>: translation keys/values for variable fields</li></ul></li></ul></li> <li><strong>type</strong> : usually <code>BaseLayer</code> for map backgrounds, <code>TerrainLayer</code> for 3D terrain, <code>OverlayLayer</code> for additionnal data layers</li> <li><strong>tags</strong> : list of tags (i.e. array of strings) used to classify the layer</li> <li><strong>icon</strong> : a <a href="https://quasar.dev/options/app-icons" target="_blank" rel="noopener noreferrer">Quasar icon<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for the layer, typically used in the <a href="/kdk/api/map/components.html#layers-panel">layers panel</a></li> <li><strong>iconUrl</strong> : a link to an image to be used as icon for the layer, typically used in the <a href="/kdk/api/map/components.html#layers-panel">layers panel</a></li> <li><strong>attribution</strong> : data attribution informaiton to be displayed along with the layer</li> <li><strong>leaflet</strong> : options to be passed to the underlying Leaflet layer constructor
<ul><li><strong>type</strong>: the type of Leaflet layer to be constructed (i.e. class/constructor function name), e.g. <code>tileLayer</code> or <code>geoJson</code></li> <li><strong>source</strong>: if provided this property is reserved for the first argument to be passed to the underlying Leaflet layer constructor, typically the URL or the GeoJson data, in this case the options will be passed as the second argument</li> <li><strong>option</strong>: all others fields are considered as options to be passed to the layer constructor</li></ul></li> <li><strong>cesium</strong>: options to be passed to the underlying Cesium layer constructor
<ul><li><strong>type</strong>: the type of Cesium layer to be constructed (i.e. class/constructor function name), e.g. <code>EllipsoidTerrainProvider</code> or <code>BingImageryProvider</code></li> <li><strong>option</strong>: all others fields are considered as options to be passed to the layer constructor</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>The <code>type</code> and <code>tags</code> attributes are typically used by the <a href="/kdk/api/map/components.html#catalog-panel">catalog panel</a> to organize the layer selection in a meaningful way.</p></div> <p>If the layer is a feature layer based on a <a href="/kdk/api/map/services.html#feature-service">feature service</a> the additional properties are the following:</p> <ul><li><strong>service</strong>: the name of the underlying feature service,</li> <li><strong>probeService</strong>: the name of the underlying feature service containing probe locations,</li> <li><strong>featureId</strong>: the name of the unique feature identifier in feature (relative to the nested <code>properties</code> object),</li> <li><strong>featureId</strong>: the name of the unique feature identifier in feature (relative to the nested <code>properties</code> object),</li> <li><strong>history</strong>: the expiration period for stored feature</li> <li><strong>variables</strong>: array of available properties in feature to be <a href="/kdk/api/map/services.html#time-based-feature-aggregation">aggregated over time</a>, for each entry the following options are available:
<ul><li><strong>name</strong>: property name in feature (relative to the nested <code>properties</code> object),</li> <li><strong>label</strong>: property label to use in UI,</li> <li><strong>units</strong>: array of target units to be available in the legend, the first unit is the one used to store the data, others will be converted from using <a href="http://mathjs.org/docs/datatypes/units.html" target="_blank" rel="noopener noreferrer">math.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>chartjs</strong>: options to be passed to <a href="https://www.chartjs.org/docs/latest/charts/line.html#dataset-properties" target="_blank" rel="noopener noreferrer">chart.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> when drawing timeseries</li></ul></li></ul> <h4 id="user-context"><a href="#user-context" class="header-anchor">#</a> User context</h4> <p>A user context consists in a map extent and a set of layers to be activated. It is used to restore a specific user view context at anytime.</p> <p>The data model of a user context as used by the API is the following:</p> <ul><li><strong>name</strong> : the context name, typically used when listing favorite views</li> <li><strong>type</strong> : <code>Context</code></li> <li><strong>south,west,north,east</strong>: context extent,</li> <li><strong>layers</strong>: array of active layer names</li></ul> <h3 id="hooks-2"><a href="#hooks-2" class="header-anchor">#</a> Hooks</h3> <p>The main <a href="/kdk/api/map/hooks.html">hooks</a> executed on the <code>catalog</code> service for layers are used to convert from/to JS/MongoDB data types:</p> <ul><li><a href="/kdk/api/core/hooks.html">convertObjectIDs</a> before hook for layer ID</li> <li><a href="/kdk/api/core/hooks.html">convertToString</a> before hook for layer schema</li> <li><a href="/kdk/api/core/hooks.html">convertToJson</a> after hook for layer schema</li></ul> <p>Additional hooks are run to update contexts whenever a layer name is updated.</p> <h2 id="features-service"><a href="#features-service" class="header-anchor">#</a> Features service</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Available as a global and a contextual service</p></div> <p>The service can be created using the global <strong>createFeaturesService(options)</strong> function, if no context provided it will be available as a global service otherwise as a contextual service (e.g. attached to a specific organization), please also refer to core module <a href="/kdk/api/core/application.html#createservice-name-options"><strong>createService()</strong></a>.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>This service does not emit events with individual features because importing large batch of features could lead to big performance drop. For the same reason, any operation result contains only the feature identifier not the whole object as usual.</p></div> <h3 id="data-model-3"><a href="#data-model-3" class="header-anchor">#</a> Data model</h3> <p>The common model is a <a href="https://tools.ietf.org/html/rfc7946#section-3.2" target="_blank" rel="noopener noreferrer">GeoJSON feature<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> with <a href="https://tools.ietf.org/html/rfc7946#section-3.1.2" target="_blank" rel="noopener noreferrer">GeoJSON point geometry<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. However, it also supports time-stamped features to manage the temporal evolution of either the geometry (e.g. a moving aircraft) or the attributes/properties (e.g. a probe). As a consequence it also usually contains the following:</p> <ul><li><strong>time</strong> : the date/time of the &quot;measure&quot; that produced the feature</li></ul> <p>The raw data model of a feature (ie when no aggregation is performed) as used by the API is detailed below.</p> <p><img src="/kdk/assets/img/feature-data-model.de64ed49.png" alt="Feature data model"></p> <h3 id="time-based-feature-aggregation"><a href="#time-based-feature-aggregation" class="header-anchor">#</a> Time-based feature aggregation</h3> <p>Sometimes it is useful to retrieve a single result aggregating all the times for a given feature instead of multiple single results (i.e. one per time). It can also ease data management when a sensor generates different features for different variables, e.g. one feature owing the measure of one variable and another feature the measure of another variable because they are not probed at the same frequency.</p> <p>You can perform such an aggregation based on <a href="https://docs.mongodb.com/manual/core/aggregation-pipeline/" target="_blank" rel="noopener noreferrer">MongoDB capabilities<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token string">'features'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  query<span class="token operator">:</span> <span class="token punctuation">{</span>
    time<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// Target time range</span>
      $gte<span class="token operator">:</span> <span class="token string">'2017-05-24T12:00:00.000Z'</span><span class="token punctuation">,</span>
      $lte<span class="token operator">:</span> <span class="token string">'2017-05-25T12:00:00.000Z'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    $groupBy<span class="token operator">:</span> <span class="token string">'properties.iata_code'</span><span class="token punctuation">,</span> <span class="token comment">// Will perform aggregation based on this unique feature identifier</span>
    <span class="token string">'properties.iata_code'</span><span class="token operator">:</span> <span class="token string">'LFBO'</span><span class="token punctuation">,</span> <span class="token comment">// The target feature to aggregate, if omitted all will be or you can provide a list with $in</span>
    $aggregate<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'geometry'</span><span class="token punctuation">,</span> <span class="token string">'speed'</span><span class="token punctuation">]</span> <span class="token comment">// List of properties to aggregate over time</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Do something with the aggregated feature</span>
</code></pre></div><p>When performing aggregation, <strong>time</strong> will become an object containing a key per aggregated element according to its name (e.g. <code>geometry</code>, <code>speed</code>). The value of each key will be the ordered list of available times for the element (unless you specified a different <code>$sort</code> order). The value of each aggregated element property (e.g. <code>properties.speed</code>) will become an array of values ordered according to ascending time (replacing the scalar property of the raw feature).</p> <p>The data model of a feature as returned by the API when some elements of the feature are aggregated over time is detailed below.</p> <p><img src="/kdk/assets/img/aggregated-feature-data-model.688823b1.png" alt="Aggregated feature data model"></p> <h3 id="advanced-feature-filtering"><a href="#advanced-feature-filtering" class="header-anchor">#</a> Advanced feature filtering</h3> <p>Features are spatially indexed based on <a href="https://docs.mongodb.com/manual/applications/geospatial-indexes/" target="_blank" rel="noopener noreferrer">MongoDB capabilities<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. So you can perform a <a href="https://docs.mongodb.com/manual/reference/operator/query-geospatial/" target="_blank" rel="noopener noreferrer">geospatial query<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> on your results like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'src/api'</span>

<span class="token keyword">const</span> collection <span class="token operator">=</span> <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token string">'features'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  query<span class="token operator">:</span> <span class="token punctuation">{</span>
    geometry<span class="token operator">:</span> <span class="token punctuation">{</span>
      $near<span class="token operator">:</span> <span class="token punctuation">{</span>
        $geometry<span class="token operator">:</span> <span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token string">'Point'</span><span class="token punctuation">,</span>
          coordinates<span class="token operator">:</span> <span class="token punctuation">[</span>longitude<span class="token punctuation">,</span> latitude<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        $maxDistance<span class="token operator">:</span> <span class="token number">10000</span> <span class="token comment">// in meters, i.e. 10 Kms around</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Do something with the resulting feature collection</span>
</code></pre></div><p>Such a complex query is fine when using the <a href="https://docs.feathersjs.com/api/client.html#universal-isomorphic-api" target="_blank" rel="noopener noreferrer">Feathers isomorphic API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> but if to be expressed manually as HTTP REST request you have to convert nested objects to array notation like this: <code>/api/features?probeId=59248de38bb91d28d8155b3c&amp;forecastTime=2017-05-27T07:00:00.000Z&amp;geometry[$near][$maxDistance]=1000000&amp;geometry[$near][$geometry][type]=Point&amp;geometry[$near][$geometry][coordinates][]=5&amp;geometry[$near][$geometry][coordinates][]=43</code>.</p> <p>The service also supports some shortcuts for the most useful types of spatial requests:</p> <ul><li><em>proximity filter</em> will trigger a <a href="https://docs.mongodb.com/manual/reference/operator/query/near/" target="_blank" rel="noopener noreferrer"><code>$near</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/geoNear/" target="_blank" rel="noopener noreferrer"><code>$geoNear</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> operation (if aggregation is performed)
<ul><li><strong>centerLon</strong>: location longitude</li> <li><strong>centerLat</strong>: location latitude</li> <li><strong>distance</strong>: query distance from location in meters</li></ul></li> <li><em>bounding box filter</em> will trigger a <a href="https://docs.mongodb.com/manual/reference/operator/query/geoIntersects/" target="_blank" rel="noopener noreferrer"><code>$geoIntersects</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> operation
<ul><li><strong>south</strong>: south coordinates of the bounding box in degrees</li> <li><strong>north</strong>: north coordinates of the bounding box in degrees</li> <li><strong>west</strong>: west coordinates of the bounding box in degrees</li> <li><strong>east</strong>: east coordinates of the bounding box in degrees</li></ul></li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>Complex spatial queries can raise an issue when using REST HTTP requests due to their length, in that case use shortcuts presented above.</p></div> <p>You can also filter results according to the computed element values by using the <a href="https://docs.feathersjs.com/api/databases/querying.html" target="_blank" rel="noopener noreferrer">Feathers common database query API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, e.g. to get results with a speed between 2 m/s and 5 m/s in a given area:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> api <span class="token keyword">from</span> <span class="token string">'src/api'</span>

<span class="token keyword">const</span> collection <span class="token operator">=</span> <span class="token keyword">await</span> api<span class="token punctuation">.</span><span class="token function">getService</span><span class="token punctuation">(</span><span class="token string">'features'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  query<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'properties.speed'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      $gte<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      $lte<span class="token operator">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    south<span class="token operator">:</span> <span class="token number">45</span><span class="token punctuation">,</span>
    north<span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
    west<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    east<span class="token operator">:</span> <span class="token number">10</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// Do something with the resulting feature collection</span>
</code></pre></div><h3 id="hooks-3"><a href="#hooks-3" class="header-anchor">#</a> Hooks</h3> <p>The following <a href="/kdk/api/map/hooks.html">hooks</a> are executed on the <code>features</code> service:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>These are mainly hooks to convert from/to JS/MongoDB data types.</p> <h2 id="alerts-service"><a href="#alerts-service" class="header-anchor">#</a> Alerts service</h2> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Available as a global and a contextual service</p></div> <p>The service can be created using the global <strong>createAlertsService(options)</strong> function, if no context provided it will be available as a global service otherwise as a contextual service (e.g. attached to a specific organization), please also refer to core module <a href="/kdk/api/core/application.html#createservice-name-options"><strong>createService()</strong></a>.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p><code>update</code> method is not allowed now, you have to recreate the alert if you'd like to update it.
<code>patch</code> method is only allowed from the server side in order to update the alert status.</p></div> <p>Alerts are user-defined conditions automatically and continuously evaluated as new time-based data are gathered and target sensor measures or forecast data. It can be viewed as an automated query of the <a href="/kdk/api/map/services.html#feature-service">feature aggregation API</a> or <a href="https://weacast.github.io/weacast-docs/api/probe.html#probes-api" target="_blank" rel="noopener noreferrer">Weacast probe API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that will raise an event or trigger a webhook whenever a matching result is found. With alerts you can create triggers which will fire on an occurrence of the selected measure or weather conditions (temperature, humidity, pressure, etc.) in a specified location and period of time.</p> <h3 id="data-model-4"><a href="#data-model-4" class="header-anchor">#</a> Data model</h3> <p>The common model is a <a href="https://tools.ietf.org/html/rfc7946#section-3.2" target="_blank" rel="noopener noreferrer">GeoJSON feature<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> with the geometry of the source feature for measurements or a <a href="https://tools.ietf.org/html/rfc7946#section-3.1.2" target="_blank" rel="noopener noreferrer">GeoJSON point<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for weather.</p> <p>The data model of an alert as used by the API is detailed below.</p> <p><img src="/kdk/assets/img/alert-data-model.77595bb5.png" alt="Alert data model"></p> <p>The details of some of the properties are the following:</p> <ul><li><p><strong>cron</strong>: a <a href="https://github.com/kelektiv/node-cron" target="_blank" rel="noopener noreferrer">CRON pattern<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to schedule the alert check at regular intervals, e.g. <code>* 0 * * * *</code> will run it every minute</p></li> <li><p><strong>feature</strong>: the ID of the feature to be checked by the alert</p></li> <li><p><strong>layer</strong>: the layer object owing the feature to be checked by the alert</p></li> <li><p><strong>elements</strong>: array of names corresponding to the probed forecast element values to be checked by the alert (each element has to be declared in the <a href="https://weacast.github.io/weacast-docs/guides/basics.html#configuring" target="_blank" rel="noopener noreferrer">weacast configuration<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p></li> <li><p><strong>period</strong>: time interval used to do the matching between the forecast data and the trigger conditions</p> <ul><li><strong>start</strong>: offset which needs to be added to the current timestamp at the moment of validation to compute the beginning of the time interval used to check the conditions, specified as <a href="https://momentjs.com/docs/#/manipulating/add/" target="_blank" rel="noopener noreferrer">moment.js duration object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><strong>end</strong>: offset which needs to be added to the current timestamp at the moment of validation to compute the end of the time interval used to check the conditions, specified as <a href="https://momentjs.com/docs/#/manipulating/add/" target="_blank" rel="noopener noreferrer">moment.js duration object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p><strong>conditions</strong>: query specification which contains nested objects:</p> <ul><li><strong>[probed element]</strong>: for each checked element a filter according to the probed values specified using the <a href="https://docs.feathersjs.com/api/databases/querying.html" target="_blank" rel="noopener noreferrer">Feathers common database query API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><p><strong>geometry</strong> specification of a <a href="https://docs.mongodb.com/manual/reference/operator/query/geoWithin/" target="_blank" rel="noopener noreferrer">geospatial query<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><strong>webhook</strong>: webhook to be triggered</p> <ul><li><strong>url</strong>: webhook target URL</li> <li><strong>xxx</strong>: request body field values that will be POST on the URL</li></ul> <h3 id="hooks-4"><a href="#hooks-4" class="header-anchor">#</a> Hooks</h3></li></ul> <p>The following <a href="/kdk/api/map/hooks.html">hooks</a> are executed on the <code>alerts</code> service:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>These are mainly hooks to convert from/to JS/MongoDB data types.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/kdk/api/map/" class="prev router-link-active">
        Overview
      </a></span> <span class="next"><a href="/kdk/api/map/hooks.html">
        Hooks
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/kdk/assets/js/app.2ba7f0d3.js" defer></script><script src="/kdk/assets/js/3.934b6e1d.js" defer></script><script src="/kdk/assets/js/6.6c7d3e51.js" defer></script><script src="/kdk/assets/js/9.07565a82.js" defer></script>
  </body>
</html>
